<!DOCTYPE html>
<html lang="en">
        <head>
                <meta charset="utf-8" />
                <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=contain">
                <title>Use sidekiq to make resque clusters run happier</title>
                <link rel="stylesheet" href="https://alexdong.com/theme/css/main.css" />
                <link href="https://alexdong.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Raw thoughts from Alex Dong Atom Feed" />
        </head>

        <body id="index" class="home">
                <header id="banner" class="body">
                <h1><a href="https://alexdong.com/">Raw thoughts from Alex Dong </a></h1>
                </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://alexdong.com/use-sidekiq-to-make-resque-clusters-run-happier.html" rel="bookmark"
           title="Permalink to Use sidekiq to make resque clusters run happier">Use sidekiq to make resque clusters run happier</a></h1>
    </header>

    <div class="entry-content">
      <h2>- code</h2>
<p>Resque is a single-thread, single-process, fork-based process. Running lots of them incurs serious swapping. There have been proposals of running <a href="http://blog.carbonfive.com/2011/09/16/improving-resques-memory-efficiency/">jruby</a> to solve this problem but looks like Sidekq and the upcoming Ruby 3.0 offer a cleaner solution.</p>
<blockquote>
<p>Sidekiq uses multithreading so it is much more memory efficient than Resque (which forks a new process for every job). You'll find that you might need 50 200MB resque processes to peg your CPU whereas one 300MB Sidekiq process will peg the same CPU and perform the same amount of work. Please see my blog post on Resque's memory efficiency and how I was able to shrink a Carbon Five client's resque processing farm from 9 machines to 1 machine.</p>
</blockquote>
<p>via <a href="https://github.com/mperham/sidekiq">mperham/sidekiq</a>.</p>
    </div><!-- /.entry-content -->
  </article>
</section>

                <footer id="contentinfo" class="body">
                </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-37221534-2', 'auto');
    ga('send', 'pageview');
    </script>
        </body>
</html>